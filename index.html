<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Restauraci√≥n de im√°genes antiguas 100% en tu navegador. Privacidad total, sin servidores.">
    <meta http-equiv="Content-Security-Policy" 
          content="default-src 'self'; 
                   script-src 'self' https://cdn.jsdelivr.net; 
                   style-src 'self' 'unsafe-inline';
                   img-src 'self' data: blob:;">
    <title>AppRestaura - Restauraci√≥n de Im√°genes Antiguas</title>
    
    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üñºÔ∏è</text></svg>">
    
    <!-- Estilos -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/responsive.css">
    
    <!-- Pica.js para redimensionamiento de alta calidad -->
    <script src="https://cdn.jsdelivr.net/npm/pica@9.0.1/dist/pica.min.js" defer></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <span class="logo-icon">üñºÔ∏è</span>
                    <h1>AppRestaura</h1>
                </div>
                <nav class="nav">
                    <button id="themeToggle" class="btn-icon" title="Cambiar tema" aria-label="Cambiar tema">
                        <span class="theme-icon">üåô</span>
                    </button>
                    <button id="helpBtn" class="btn-icon" title="Ayuda" aria-label="Ayuda">
                        <span>‚ùì</span>
                    </button>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Upload Section -->
            <section class="upload-section" id="uploadSection">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-content">
                        <span class="upload-icon">üìÅ</span>
                        <h2>Arrastra tu imagen aqu√≠</h2>
                        <p>o</p>
                        <label for="fileInput" class="btn-primary">
                            Seleccionar Imagen
                        </label>
                        <input type="file" id="fileInput" accept="image/jpeg,image/png,image/webp,image/bmp" hidden>
                        <p class="upload-info">JPG, PNG, WEBP o BMP ‚Ä¢ M√°x. 10MB</p>
                    </div>
                </div>
            </section>

            <!-- Editor Section -->
            <section class="editor-section hidden" id="editorSection">
                <!-- Toolbar -->
                <div class="toolbar">
                    <button id="resetBtn" class="btn-secondary" title="Reiniciar imagen">
                        <span>‚Ü∫</span> Reiniciar
                    </button>
                    <button id="undoBtn" class="btn-secondary" title="Deshacer" disabled>
                        <span>‚Ü∂</span> Deshacer
                    </button>
                    <button id="cropBtn" class="btn-secondary" title="Recortar imagen">
                        <span>‚úÇÔ∏è</span> Recortar
                    </button>
                    <button id="healBtn" class="btn-secondary" title="Reparar defectos">
                        <span>ü©π</span> Reparar
                    </button>
                    <button id="compareBtn" class="btn-secondary" title="Comparar antes/despu√©s">
                        <span>üëÅÔ∏è</span> Comparar
                    </button>
                    <button id="downloadBtn" class="btn-primary" title="Descargar imagen">
                        <span>üíæ</span> Descargar
                    </button>
                    <button id="newImageBtn" class="btn-secondary" title="Cargar nueva imagen">
                        <span>üìÅ</span> Nueva
                    </button>
                </div>

                <!-- Canvas Area -->
                <div class="canvas-container">
                    <div class="canvas-wrapper">
                        <canvas id="originalCanvas" class="canvas"></canvas>
                        <canvas id="processedCanvas" class="canvas"></canvas>
                        <div class="compare-slider hidden" id="compareSlider">
                            <div class="slider-handle">
                                <span>‚ü∑</span>
                            </div>
                        </div>
                        <!-- Crop Overlay -->
                        <div id="cropOverlay" class="crop-overlay hidden">
                            <div id="cropArea" class="crop-area">
                                <div class="crop-handle crop-handle-nw"></div>
                                <div class="crop-handle crop-handle-ne"></div>
                                <div class="crop-handle crop-handle-sw"></div>
                                <div class="crop-handle crop-handle-se"></div>
                                <div class="crop-center">‚úÇÔ∏è</div>
                            </div>
                        </div>
                    </div>
                    <div class="canvas-info" id="canvasInfo">
                        <span id="imageDimensions"></span>
                        <span id="imageSize"></span>
                    </div>
                </div>

                <!-- Crop Controls (hidden by default) -->
                <div id="cropControls" class="crop-controls hidden">
                    <div class="crop-controls-header">
                        <h4>üéØ Herramienta de Recorte</h4>
                        <p>Arrastra el √°rea o las esquinas para ajustar</p>
                    </div>
                    <div class="crop-aspect-ratios">
                        <button class="crop-ratio-btn active" data-ratio="free">Libre</button>
                        <button class="crop-ratio-btn" data-ratio="1:1">1:1</button>
                        <button class="crop-ratio-btn" data-ratio="4:3">4:3</button>
                        <button class="crop-ratio-btn" data-ratio="16:9">16:9</button>
                        <button class="crop-ratio-btn" data-ratio="3:2">3:2</button>
                    </div>
                    <div class="crop-actions">
                        <button id="cropApplyBtn" class="btn-primary">
                            <span>‚úì</span> Aplicar Recorte
                        </button>
                        <button id="cropCancelBtn" class="btn-secondary">
                            <span>‚úï</span> Cancelar
                        </button>
                    </div>
                </div>

                <!-- Healing Controls (hidden by default) -->
                <div id="healingControls" class="healing-controls hidden">
                    <div class="healing-controls-header">
                        <h4>ü©π Herramienta de Reparaci√≥n</h4>
                        <p>Click o arrastra sobre defectos para eliminarlos</p>
                    </div>
                    <div class="healing-brush-size">
                        <label for="healBrushSlider" class="control-label">
                            <span>üñåÔ∏è Tama√±o del Pincel</span>
                            <span id="healBrushValue" class="control-value">20</span>
                        </label>
                        <input type="range" id="healBrushSlider" class="slider" 
                               min="5" max="100" value="20" step="1">
                    </div>
                    <div class="healing-actions">
                        <button id="healUndoBtn" class="btn-secondary">
                            <span>‚Ü∂</span> Deshacer √öltimo
                        </button>
                        <button id="healResetBtn" class="btn-secondary">
                            <span>‚Ü∫</span> Resetear Todo
                        </button>
                        <button id="healDoneBtn" class="btn-primary">
                            <span>‚úì</span> Finalizar
                        </button>
                    </div>
                </div>

                <!-- Controls Panel -->
                <div class="controls-panel">
                    <div class="controls-header">
                        <h3>Ajustes de Restauraci√≥n</h3>
                        <button id="resetFiltersBtn" class="btn-text">Restablecer Todo</button>
                    </div>

                    <div class="controls-grid">
                        <!-- Brillo -->
                        <div class="control-group">
                            <label for="brightnessSlider" class="control-label">
                                <span>‚òÄÔ∏è Brillo</span>
                                <span id="brightnessValue" class="control-value">0</span>
                            </label>
                            <input type="range" id="brightnessSlider" class="slider" 
                                   min="-100" max="100" value="0" step="1">
                        </div>

                        <!-- Contraste -->
                        <div class="control-group">
                            <label for="contrastSlider" class="control-label">
                                <span>‚óê Contraste</span>
                                <span id="contrastValue" class="control-value">0</span>
                            </label>
                            <input type="range" id="contrastSlider" class="slider" 
                                   min="-100" max="100" value="0" step="1">
                        </div>

                        <!-- Saturaci√≥n -->
                        <div class="control-group">
                            <label for="saturationSlider" class="control-label">
                                <span>üé® Saturaci√≥n</span>
                                <span id="saturationValue" class="control-value">0</span>
                            </label>
                            <input type="range" id="saturationSlider" class="slider" 
                                   min="-100" max="100" value="0" step="1">
                        </div>

                        <!-- Nitidez -->
                        <div class="control-group">
                            <label for="sharpnessSlider" class="control-label">
                                <span>üîç Nitidez</span>
                                <span id="sharpnessValue" class="control-value">0</span>
                            </label>
                            <input type="range" id="sharpnessSlider" class="slider" 
                                   min="0" max="100" value="0" step="1">
                        </div>

                        <!-- Reducci√≥n de Ruido -->
                        <div class="control-group">
                            <label for="denoiseSlider" class="control-label">
                                <span>‚ú® Reducci√≥n de Ruido</span>
                                <span id="denoiseValue" class="control-value">0</span>
                            </label>
                            <input type="range" id="denoiseSlider" class="slider" 
                                   min="0" max="100" value="0" step="1">
                        </div>

                        <!-- Temperatura de Color -->
                        <div class="control-group">
                            <label for="temperatureSlider" class="control-label">
                                <span>üå°Ô∏è Temperatura</span>
                                <span id="temperatureValue" class="control-value">0</span>
                            </label>
                            <input type="range" id="temperatureSlider" class="slider" 
                                   min="-100" max="100" value="0" step="1">
                        </div>

                        <!-- Filtros R√°pidos -->
                        <div class="control-group full-width">
                            <label class="control-label">
                                <span>üé≠ Filtros R√°pidos</span>
                            </label>
                            <div class="quick-filters">
                                <button class="filter-btn" data-filter="grayscale">Escala de Grises</button>
                                <button class="filter-btn" data-filter="sepia">Sepia</button>
                                <button class="filter-btn" data-filter="vintage">Vintage</button>
                                <button class="filter-btn" data-filter="enhance">Auto-Mejorar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>
                üîí Todas las im√°genes se procesan localmente en tu navegador. 
                Nunca se env√≠an a ning√∫n servidor.
            </p>
            <p class="footer-links">
                <a href="https://github.com/tu-usuario/AppRestaura" target="_blank" rel="noopener">GitHub</a> ‚Ä¢ 
                <a href="#" id="privacyLink">Privacidad</a> ‚Ä¢ 
                <span>v1.0.0</span>
            </p>
        </div>
    </footer>

    <!-- Modal de Ayuda -->
    <div class="modal hidden" id="helpModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üí° C√≥mo usar AppRestaura</h2>
                <button class="modal-close" id="closeHelpModal">‚úï</button>
            </div>
            <div class="modal-body">
                <ol>
                    <li><strong>Carga una imagen:</strong> Arrastra una foto antigua o haz clic en "Seleccionar Imagen"</li>
                    <li><strong>Ajusta los controles:</strong> Usa los deslizadores para mejorar brillo, contraste, saturaci√≥n, etc.</li>
                    <li><strong>Prueba filtros r√°pidos:</strong> Aplica efectos predefinidos con un clic</li>
                    <li><strong>Compara resultados:</strong> Usa el bot√≥n "Comparar" para ver antes y despu√©s</li>
                    <li><strong>Descarga:</strong> Guarda tu imagen restaurada en alta calidad</li>
                </ol>
                <div class="tips">
                    <h3>‚ú® Consejos:</h3>
                    <ul>
                        <li>Ajusta el brillo y contraste primero para mejorar la visibilidad</li>
                        <li>Usa la reducci√≥n de ruido para fotos con grano</li>
                        <li>La nitidez puede ayudar a recuperar detalles borrosos</li>
                        <li>Experimenta con diferentes combinaciones</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div class="toast hidden" id="toast">
        <span id="toastMessage"></span>
    </div>

    <!-- Loading Spinner -->
    <div class="loading hidden" id="loading">
        <div class="spinner"></div>
        <p>Procesando imagen...</p>
    </div>

    <!-- Scripts -->
    <script src="js/utils.js"></script>
    <script src="js/filters.js"></script>
    <script src="js/crop-tool.js"></script>
    <script src="js/healing-tool.js"></script>
    <script src="js/image-processor.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
